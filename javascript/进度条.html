<!DOCTYPE html>
<html>

    <head>
        <meta charset="UTF-8">
        <title></title>
        <style type="text/css">
        	.progress__container {
        	    width: 500px;
        	    height: 20px;
        	    background-color: #ccc;
        	    border-radius: 10px;
        	}
        </style>
    </head>

    <body>
        <div class="progress__container">
            <div id="myDiv" style="background-color: lightblue;width: 0;height: 20;line-height: 20px;border-radius: 10px;">0%</div>
        </div>
        <button id="btn">run</button>
        <script type="text/javascript">
            var timer,
                myDiv = document.getElementById('myDiv'),
                btn = document.getElementById('btn');

            btn.onclick = function() {
                clearInterval(timer);
                myDiv.style.width = 0;
                timer = setInterval(function() {
                    if (parseInt(myDiv.style.width) < 500) {
                    	myDiv.style.width = parseInt(myDiv.style.width) + 5 + 'px';
                    	myDiv.innerHTML = parseInt(myDiv.style.width)/5 + '%';
                    } else {
                        clearInterval(timer);
                    }
                }, 16);
            }
        </script>


        <div class="progress__container">
            <div id="myDiv2" style="background-color: lightblue;width: 0;height: 20;line-height: 20px;border-radius: 10px;">0%</div>
        </div>
        <button id="btn2">run</button>
        <script type="text/javascript">
            var timer2;
            var myDiv2 = document.getElementById('myDiv2');
            var btn2 = document.getElementById('btn2');

            btn2.onclick = function() {
//              myDiv2.style.width = 0;
//
//
//              if (!window.requestAnimationFrame) {
//                  clearInterval(timer);
//
//                  timer2 = setInterval(function() {
//                      if (parseInt(myDiv2.style.width) < 500) {
//                          myDiv2.style.width = parseInt(myDiv2.style.width) + 5 + 'px';
//                          myDiv2.innerHTML = parseInt(myDiv2.style.width)/5 + '%';
//                      } else {
//                          clearInterval(timer2);
//                      }
//                  }, 16);
//              } else {
//                  cancelAnimationFrame(timer2);
//
//                  timer2 = requestAnimationFrame(function fn2() {
//                      if (parseInt(myDiv2.style.width) < 500) {
//                          myDiv2.style.width = parseInt(myDiv2.style.width) + 5 + 'px';
//                          myDiv2.innerHTML = parseInt(myDiv2.style.width)/5 + '%';
//                          timer2 = requestAnimationFrame(fn2);
//                      } else {
//                          cancelAnimationFrame(timer2);
//                      }
//                  })
//              }

                progressBar(myDiv2, 300);
            }

            /**
             * @param {object} 进度的元素
             * @param {number} 进度长度
             * @return *
             */
            function progressBar(progressEle, progressWidth) {
                var timer;

                progressEle.style.width = 0;

                if (!window.requestAnimationFrame) {
                	clearInterval(timer);

                	timer = setInterval(function() {

                	    if (parseInt(progressEle.style.width) < progressWidth) {
                            progressEle.style.width = parseInt(progressEle.style.width) + 5 + 'px';
                            progressEle.innerHTML = parseInt(progressEle.style.width) / 5 + '%';
                	    } else {
                	        clearInterval(timer);
                	    }
                	}, 16);

                } else {

                    cancelAnimationFrame(timer2);

                    timer = requestAnimationFrame(function fn2() {
                        if (parseInt(progressEle.style.width) < progressWidth) {
                            progressEle.style.width = parseInt(progressEle.style.width) + 5 + 'px';
                            progressEle.innerHTML = parseInt(progressEle.style.width)/5 + '%';
                            timer = requestAnimationFrame(fn2);
                        } else {
                            cancelAnimationFrame(timer);
                        }
                    });

                }
            }

        </script>
    </body>

</html>